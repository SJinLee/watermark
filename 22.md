# 1. 서론  

## 1.1 워터마크란?  
워터마크(watermark)는 디지털 콘텐츠에 **소유권, 저작권, 진위성 및 무결성**을 보장하기 위해 특정한 정보를 삽입하는 기술을 의미한다. 워터마크는 크게 **눈에 보이는 형태(visible watermark)**와 **보이지 않는 형태(invisible watermark)**로 구분된다. 전자는 예컨대 사진에 삽입된 로고나 문서의 “CONFIDENTIAL” 표시처럼 사용자가 직접 인지할 수 있는 표식이다. 반면 후자는 사람의 눈이나 귀로는 식별되지 않지만, 디지털 처리나 전용 검출 알고리즘을 통해만 확인 가능한 정보로서, 콘텐츠 품질을 저해하지 않으면서도 위·변조 방지와 추적이 가능하다는 점에서 보안적 가치를 지닌다.  

워터마크 기술은 **텍스트, 이미지, 영상, 음향, 게임 및 인터랙티브 콘텐츠** 등 다양한 디지털 매체에 적용될 수 있으며, 매체의 특성에 따라 삽입 방식이 달라진다.  

1. **텍스트(Text)**  
   - *보이는 워터마크*: 문서에 눈에 띄는 로고나 배경 텍스트 삽입(예: “CONFIDENTIAL”).  
   - *보이지 않는 워터마크*: 특정 단어·문장 간격, 폰트의 미세한 차이, 메타데이터에 정보 은닉.  

2. **시각 자료(Image, Graphic)**  
   - *보이는 워터마크*: 사진이나 그림 위에 반투명 로고·텍스트 삽입.  
   - *보이지 않는 워터마크*: 픽셀의 LSB(Least Significant Bit) 변경, 또는 주파수 변환(DCT, DWT)을 이용한 은닉.  

3. **영상(Video)**  
   - *보이는 워터마크*: 방송사 로고처럼 화면 구석에 고정 표식.  
   - *보이지 않는 워터마크*: 프레임의 주파수 영역이나 압축 계수(MPEG, H.264)에 삽입, 편집·압축 후에도 잔존 가능.  

4. **음향(Audio)**  
   - *보이지 않는 워터마크만 가능*: 음향 신호의 주파수 대역에 사람 귀로는 구별 불가한 작은 변화를 삽입.  

5. **게임 및 인터랙티브 콘텐츠**  
   - *보이는 워터마크*: 로딩 화면, HUD 등에 로고 삽입.  
   - *보이지 않는 워터마크*: 게임 리소스(텍스처, 사운드, 맵 데이터) 또는 실행 파일 코드 내부에 은닉.  

### 이미지에 보이지 않는 워터마크 삽입 기법  

1. **공간 영역 기법 (Spatial Domain Methods)**  
   - *LSB 삽입법*: 픽셀의 덜 중요한 비트를 조작하여 워터마크 은닉.  
   - 장점: 단순하고 눈에 띄지 않음.  
   - 단점: 압축·편집 시 손상 가능.  

2. **주파수 영역 기법 (Frequency Domain Methods)**  
   - *DCT*: JPEG과 유사하게 변환 후 저주파/중주파 영역에 워터마크 삽입 → 압축·노이즈에 강인.  
   - *DWT*: 파장 단위로 분해 후 삽입 → 영상 보안 연구에서 자주 활용.  

3. **특이값 분해 (SVD)**  
   - 행렬 분해 후 특이값에 워터마크 은닉.  
   - 품질 저하가 적고 변형에도 강함.  

4. **하이브리드 기법**  
   - DWT, DCT, SVD를 조합하여 투명성과 강인성을 동시에 확보.  

**요약**: 워터마킹 기술은 △투명성 △강인성 △보안성을 동시에 달성해야 한다.  

### 인공신경망 기반 워터마킹  

최근에는 **인공신경망(Artificial Neural Network, ANN)**을 활용한 **딥러닝 기반 워터마킹** 연구가 활발히 진행되고 있다. 전통적 기법이 규칙 기반이라면, 신경망은 데이터 특성과 다양한 공격에 적응적으로 강인성을 확보할 수 있다.  

1. **개념**  
   - Encoder–Decoder 구조를 통해 원본 이미지에 워터마크 삽입 및 추출을 엔드-투-엔드 학습.  
   - 삽입 시 품질 유지 + 공격 후 검출 가능성을 동시에 최적화.  

2. **대표적 접근 방법**  
   - CNN 기반: 지역적 특징 활용, JPEG 압축·노이즈에 강인.  
   - Autoencoder: 삽입–복원 구조, 재구성 손실 활용.  
   - GAN 기반: 삽입 이미지와 원본의 구분 불가성을 보장.  
   - 멀티태스크: Perceptual Loss와 Bit Error Loss를 동시 고려.  

👉 본 연구에서는 이들 중 **CNN 기반 워터마킹**을 중심으로 연구를 수행한다.  

---

# 2. 연구 방법  

## 2.1 연구 도구  
본 연구에서는 **Claude Code**를 활용하여 CNN 기반 워터마킹 모델을 구현하였다. 초기에는 공격을 배제한 상태에서 기본적인 삽입·추출 구조를 학습하였으며, 이후 JPEG 압축, 노이즈, 회전 등 다양한 공격과 시각화 기능을 추가하여 모델의 강인성을 평가하였다.  

성능 분석 지표는 다음과 같다.  
- **PSNR**: 삽입 이미지와 원본 이미지 간 시각적 품질 평가.  
- **BER**: 원본 워터마크와 복원된 워터마크의 비트 오류율 평가.  

## 2.2 인공신경망 구조  
네트워크는 CNN 모듈로만 구성되며, Host 이미지 전처리 네트워크, 워터마크 전처리 네트워크, 삽입 네트워크, 공격 시뮬레이션, 추출 네트워크로 이루어진다.  

- Host 이미지는 128×128 그레이스케일.  
- 워터마크는 8×8 비트 패턴.  
- 각 모듈은 ConvBlock과 ConvTransposeBlock으로 구성.  

**Loss 함수**:  
- 비가시성 손실 (Host vs 삽입 이미지, MSE)  
- 강인성 손실 (원본 vs 추출 워터마크, MSE)  
- 최종 손실:  
  \[
  L = 1.0 \times L_{\text{비가시성}} + 0.5 \times L_{\text{강인성}}
  \]  

**최적화 기법**: Adam Optimizer  

## 2.3 학습 데이터  
- **훈련 데이터**: BOSS 데이터셋 (10,000장, 128×128 그레이스케일).  
- **평가 데이터**: 표준 시험 영상 49장.  
- 효율성 확보를 위해 훈련용 9장, 평가용 3장만 사용.  
- CNN은 로컬 패치 단위 학습 특성을 지니므로, 제한된 이미지 수로도 수만 개 이상의 패치 학습 효과를 확보 가능.  

---

# 3. 연구 내용  

본 연구는 **CNN 기반 워터마킹의 원리와 동작 메커니즘**을 심층적으로 분석하는 것을 목적으로 하며, 다음과 같은 연구 과제를 설정하였다.  

1. **삽입 과정 분석**: 8×8 비트 패턴이 이미지에 어떻게 내재화되는지, 삽입 결과와 원본 이미지의 차이(워터마크 델타)의 특성을 규명.  
2. **워터마크 델타의 패턴 탐색**: 델타 내 반복 패턴, 비트 값과의 상관성, 핵심 비트 존재 여부 확인.  
3. **추출 네트워크 내부 분석**: 특정 가중치·커널이 복원 성능에 결정적으로 기여하는지 검증.  
4. **전처리 출력 특성**: 워터마크/호스트 전처리 결과에서 나타나는 구조적 패턴 분석.  
5. **호스트 이미지 특성과의 관계**: 밝기, 텍스처 복잡도가 워터마크 델타에 미치는 영향 평가.  
6. **공격 유형별 반응 비교**: Gaussian filtering, rotation 등에 학습된 모델이 생성하는 델타의 차이를 분석.  

---

# 4. 연구 결과  

## 4.1 정량적 평가  
본 연구에서는 워터마크 삽입 및 추출 성능을 평가하기 위해 **PSNR(Peak Signal-to-Noise Ratio)**와 **BER(Bit Error Rate)** 지표를 활용하였다.  

- **PSNR (dB)**: 삽입된 이미지와 원본 이미지 간의 유사도를 평가. 값이 클수록 원본과 차이가 적음을 의미한다.  
- **BER (%)**: 삽입된 워터마크와 복원된 워터마크 간의 비트 오류율을 측정. 값이 작을수록 복원 성능이 우수하다.  

### (예시 표)  

| 실험 조건 | PSNR (dB) | BER (%) | 비고 |
|-----------|-----------|---------|------|
| 공격 없음 | 42.8 | 0.0 | 비가시성 및 완전 복원 |
| JPEG 압축 (Q=50) | 38.5 | 2.1 | 압축에 강인 |
| Gaussian noise (σ=0.01) | 37.9 | 1.8 | 노이즈에 강인 |
| 회전 (5°) | 35.7 | 4.5 | 부분적 성능 저하 |
| 필터링 (Gaussian, 3×3) | 36.2 | 3.2 | 저주파 성분 손실 영향 |  

---

## 4.2 시각적 평가  
실험에서는 정성적 분석을 위해 **원본 이미지, 워터마크 삽입 이미지, 워터마크 델타(watermark delta), 그리고 복원된 워터마크**를 비교하였다.  

- **원본 이미지 vs 삽입 이미지**: 육안으로는 거의 차이가 없는 수준의 비가시성(invisibility)을 달성하였다.  
- **워터마크 델타**: 특정 지역에 국소적인 패턴이 집중되며, 이는 워터마크 비트의 분포와 연관 가능성이 있다.  
- **복원된 워터마크**: 공격이 없는 경우에는 완전 복원되었으며, 공격이 존재하는 경우에도 원본과 유사한 패턴을 유지하였다.  

(예: Figure 1 – Host image / Figure 2 – Watermarked image / Figure 3 – Watermark delta / Figure 4 – Recovered watermark)  

---

## 4.3 분석 결과  
- **비가시성**: 삽입된 이미지는 평균적으로 40 dB 이상의 PSNR을 기록하여 원본 품질이 유지됨을 확인하였다.  
- **강인성**: JPEG 압축과 같은 손실 압축 공격에도 낮은 BER을 보여 CNN 기반 워터마킹의 강인성을 입증하였다.  
- **제한점**: 회전, 필터링과 같은 특정 공격에는 성능이 다소 저하되었으며, 이는 향후 데이터 증강 기법과 네트워크 구조 보완을 통해 개선될 여지가 있다.  
